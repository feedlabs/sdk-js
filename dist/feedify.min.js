!function(t){var e=function(t,e){this.objectList={},this.defaultEntryIds=[],this.outputContainer=null,this.defaultOptions={feedId:"",outputContainerId:"defaultContainerId",defaultElementLayout:"",defaultElementCount:0},this.options=this._extend(this.defaultOptions,t),this.stylerFunction=e||this._stylerFunction,this.outputContainer=document.getElementById(this.options.outputContainerId),this._addDefaultEntries();var n=this;setTimeout(function(){var t="http://www.feedify.dev:10111/v1/feed/"+n.options.feedId+"/entry";n.load(t,function(t){n._loadFirstEntries(JSON.parse(t.responseText))})},1500);var i=this.getSocketRedisClient("http://www.feedify.dev:8090");return i.subscribe("iO5wshd5fFE5YXxJ/hfyKQ==:17",(new Date).getTime(),{sessionId:"55e10ffb7ba3ca6d8fd39f25cd64253d"},function(t,e){n.processData(e.data)}),this._loadFirstEntries=function(t){for(var e in t)if(t.hasOwnProperty(e)){var i=t[e];n.add(i)}this._removeDefaultEntries()},this.processData=function(t){switch(t.Action){case"add":this.add(t);break;case"remove":this.remove(t);break;case"update":this.update(t);break;default:console.log("Unknown action `"+t.Action+"`")}},this.add=function(t){console.log(t);var e=t.Id;this.objectList[e]=e;var n=document.createElement("div");n.id=e,n.innerHTML=this.stylerFunction(t.Data),this.outputContainer.insertBefore(n,this.outputContainer.firstChild)},this.remove=function(t){var e=document.getElementById(t.Id);e.remove(),delete this.objectList[t.Id]},this.update=function(t){var e=document.getElementById(t.Id);e.innerHTML=this.stylerFunction(t.Data)},this.load=function(t,e){function n(){i.readyState<4||200===i.status&&4===i.readyState&&e(i)}var i;if("undefined"!=typeof XMLHttpRequest)i=new XMLHttpRequest;else for(var o=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],a=0,r=o.length;r>a;a++)try{i=new ActiveXObject(o[a]);break}catch(s){}i.onreadystatechange=n,i.open("GET",t,!0),i.send("")},this};e.prototype._uniqueId=function(){return"_"+Math.random().toString(36).substr(2,9)},e.prototype._addDefaultEntries=function(){for(var t=1;t<=this.options.defaultElementCount;t++){var e=this._uniqueId(),n=document.createElement("div");n.id=e,n.innerHTML=this.options.defaultElementLayout,this.outputContainer.appendChild(n),this.defaultEntryIds.push(e)}},e.prototype._removeDefaultEntries=function(){this.defaultEntryIds.forEach(function(t){var e=document.getElementById(t);e.parentNode.removeChild(e)})},e.prototype._stylerFunction=function(t){return JSON.stringify(t)},e.prototype._extend=function(t,e){var n,i={};for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);for(n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);return i},e.prototype.getSocketRedisClient=function(e){function n(e){var n=this;s(100,5e3,function(t,s){i=new SockJS(e),i.onopen=function(){s();for(var t in o)o.hasOwnProperty(t)&&r(t,a);a=null,n.onopen.call(n)},i.onmessage=function(t){var e=JSON.parse(t.data);o[e.channel]&&o[e.channel].callback.call(n,e.event,e.data)},i.onclose=function(){a=(new Date).getTime(),t(),n.onclose.call(n)}}),t.addEventListener&&t.addEventListener("keydown",function(t){27==t.keyCode&&t.preventDefault()})}var i,o={},a=null;n.prototype.subscribe=function(t,e,n,a){if(o[t])throw"Channel `"+t+"` is already subscribed";o[t]={event:{channel:t,start:e,data:n},callback:a},i.readyState===SockJS.OPEN&&r(t)},n.prototype.unsubscribe=function(t){o[t]&&delete o[t],i.readyState===SockJS.OPEN&&i.send(JSON.stringify({event:"unsubscribe",data:{channel:t}}))},n.prototype.send=function(t){i.send(JSON.stringify({event:"message",data:{data:t}}))},n.prototype.publish=function(t,e,n){i.send(JSON.stringify({event:"publish",data:{channel:t,event:e,data:n}}))},n.prototype.onopen=function(){},n.prototype.onclose=function(){};var r=function(t,e){var n=o[t].event;e||(e=n.start||(new Date).getTime()),i.send(JSON.stringify({event:"subscribe",data:{channel:n.channel,data:n.data,start:e}}))},s=function(e,n,i){var o,a=e,r=function(){a=e,t.clearTimeout(o)},s=function(){var d=this;t.clearTimeout(o),o=t.setTimeout(function(){i.call(d,s,r),a=Math.min(Math.max(e,2*a),n)},a)};i.call(this,s,r)};return new n(e)},"function"==typeof define?define(function(){return e}):t.FeedPlugin=e}(window);